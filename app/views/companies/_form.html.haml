= bootstrap_form_for(@company) do |f|
  - if @company.errors.any?
    #error_explanation
      %h2
        = pluralize(@company.errors.count, "error")
        prohibited this company from being saved:
      %ul
        - @company.errors.full_messages.each do |message|
          %li= message
  %h4.lead-heading.mt-0 Basic Details
  .lead-body
    .row
      .col-md-3
        .form-group
          = f.text_field :name, class: "form-control", placeholder: "Name"
      .col-md-3
        .form-group
          = f.text_field :domain, class: "form-control", placeholder: "Domain"
      .col-md-3
        .form-group
          = f.text_field :mobile_domain, class: "form-control", placeholder: "Mobile Domain"
      .col-md-3
        .form-group
          = f.text_field :partner_crm_url, class: "form-control", placeholder: "Partner Crm Url"
      .col-md-3
        .form-group
          = f.text_field :postsale_url, class: "form-control", placeholder: "PostSales Api URL"
      .col-md-3.required
        .form-group
          = f.text_field :sms_mask, class: "form-control", placeholder: "Sms Mask"
      .col-md-3
        .form-group
          = f.select :new_status_id, options_from_collection_for_select(::Status.of_leads, :id, :name, @company.new_status_id), { include_blank: "Please Select", label: "New Lead Status" }, class: 'form-control'
      .col-md-3
        .form-group
          = f.select :expected_site_visit_id, options_from_collection_for_select(::Status.of_leads, :id, :name, @company.expected_site_visit_id), { include_blank: "Please Select" }, class: 'form-control'
      .col-md-3
        .form-group
          = f.select :site_visit_done_id, options_from_collection_for_select(::Status.of_leads, :id, :name, @company.site_visit_done_id), { include_blank: "Please Select" }, class: 'form-control'
      .col-md-3.required
        .form-group
          = f.select :booking_done_id, options_from_collection_for_select(::Status.of_leads, :id, :name, @company.booking_done_id), { include_blank: "Please Select" }, class: 'form-control'
      .col-md-3.ch-select
        = f.select :cost_sheet_letter_types, options_for_select(["letter1", "letter2"], @company.cost_sheet_letter_types), {}, multiple: true, class: 'form-control chosen-select'
      .col-md-3
        = f.text_field :users_count, class: "form-control", placeholder: "Enter users count"
  %h4.lead-heading
    Logo Upload
  .lead-body
    .row
      .col-md-4
        .form-group
          %label{ for: "exampleInputFile" } Upload Logo:
          
          = f.file_field :logo, class: 'form-control', hide_label: true
          %span{ style: " font-size: 12px; opacity:.7"} Jpg, Png Format allowed max size 500 KB
      .col-md-4
        .form-group
          %label{ for: "exampleInputFile" } Upload Icon:
          
          
          = f.file_field :icon, class: 'form-control', hide_label: true
          %span{ style: " font-size: 12px; opacity:.7"} Jpg, Png Format allowed max size 500 KB
      .col-md-4
        .form-group
          %label{ for: "exampleInputFile" } Upload Favicon:
          
          
          = f.file_field :favicon, class: 'form-control', hide_label: true
          %span{ style: " font-size: 12px; opacity:.7"} Jpg, Png Format allowed max size 500 KB
  %h4.lead-heading
    Multiple Select
    %span{ style: " font-size: 12px; opacity:.7"} (Status/sources/site visit)
  .lead-body
    .row
      .col-md-6.required
        .form-group
          = f.select :dead_status_ids, options_from_collection_for_select(::Status.of_leads, :id, :name, @company.dead_status_ids), { include_blank: "Please Select" }, class: 'form-control multiselect', multiple: true
      .col-md-6
        %label
          Expected Site visit
        .form-group
          = f.select :expected_visit_ids, options_from_collection_for_select(::Status.of_leads, :id, :name, @company.expected_visit_ids), { include_blank: "Please Select", skip_label: true }, class: 'form-control multiselect', multiple: true, skip_label: true
          %span{ style: "font-style: italic; font-size: 9pt; color: rgba(0,0,0,0.5)" }
            %p (Configure only to the clients Onboarded after sept-12)
      .col-md-6
        .form-group
          = f.select :token_status_ids, options_from_collection_for_select(::Status.of_leads, :id, :name, @company.token_status_ids), { include_blank: "Please Select" }, class: 'form-control multiselect', multiple: true
      .col-md-6
        .form-group
          = f.select :hot_status_ids, options_from_collection_for_select(::Status.of_leads, :id, :name, @company.hot_status_ids), { include_blank: "Please Select" }, class: 'form-control multiselect', multiple: true
      .col-md-6
        .form-group
          = f.select :allowed_fields, options_for_select((::Company.allowed_options).map { |k| [k.humanize, k] }, f.object.allowed_fields), {}, class: "form-control multiselect", multiple: true
      .col-md-6
        .form-group
          = f.select :popup_fields, options_for_select((::Company.detail_fields).map { |k| [k.humanize, k] }, f.object.popup_fields), {}, class: "form-control multiselect", multiple: true
      .col-md-6
        .form-group
          = f.select :index_fields, options_for_select((::Company.detail_fields).map { |k| [k.humanize, k] }, f.object.index_fields), {}, class: "form-control multiselect", multiple: true
      .col-md-6
        .form-group
          = f.select :required_fields, options_for_select((::Company.required_options).map { |k| [k.humanize, k] }, f.object.required_fields), { include_blank: false, include_hidden: false }, class: "form-control multiselect", multiple: true
      .col-md-6
        .form-group
          = f.select :visits_allowed_fields, options_for_select((::Company.visits_allowed_options).map { |k| [k.humanize, k] }, f.object.visits_allowed_fields), {}, class: "form-control multiselect", multiple: true
      .col-md-6
        .form-group
          = f.label :lead_status
          = f.collection_select :status_ids, Status.all, :id, :name, { hide_label: 'true' },class: "form-control multiselect", multiple: true
      .col-md-6
        .form-group
          = f.label :card_status
          = f.collection_select :card_status, ::Status.of_leads, :id, :name, { hide_label: 'true' }, class: "form-control multiselect", multiple: true
      .col-md-6
        .form-group
          = f.label :enquiry_sources
          = f.collection_select :source_ids, Source.all, :id, :name, { hide_label: 'true' }, class: "form-control multiselect", multiple: true
      .col-md-6
        .form-group
          = f.label :closing_executive_trigger_statuses
          = f.collection_select :closing_executive_trigger_statuses, Status.all, :id, :name, { hide_label: 'true' }, class: "form-control multiselect", multiple: true
      .col-md-6
        .form-group
          = f.label :customize_report_status_ids
          = f.select :customize_report_status_ids, options_from_collection_for_select(::Status.of_leads, :id, :name, @company.customize_report_status_ids), { hide_label: 'true', include_blank: "Please Select" }, class: 'form-control multiselect', multiple: true
  %h4.lead-heading
    Requirement
  .lead-body
    .row
      .col-md-6
        .pl-3
          = f.check_box :requirement, class: "form-check-input mb-0 "
  %h4.lead-heading
    Stages
  .lead-body
    .row
      .col-md-12
        #company_stages.row
          = f.fields_for :company_stages do |reason|
            = render "company_stage_fields", f: reason
          .links.pl-2
            = link_to_add_association "Add Stage", f, :company_stages, class: "btn btn-primary"
  %h4.lead-heading
    Rejection Reasons
  .lead-body
    .row
      .col-md-12
        #reasons.row
          = f.fields_for :reasons do |reason|
            = render "reason_fields", f: reason
          .links.pl-2
            = link_to_add_association "Add Reason", f, :reasons, class: "btn btn-primary"
      
  - if f.object.persisted?
    %h4.lead-heading
      Map Role Status
    .lead-body
      .row
        .col-md-12
          #reasons.row
            = f.fields_for :role_statuses do |status|
              = render "role_status_fields", f: status
            .links.pl-2
              = link_to_add_association "Map Role Status", f, :role_statuses, class: "btn btn-primary"
  %h4.lead-heading
    Custom Fields
  .lead-body
    .row
      .col-md-12
        #magic_fields.row
          = f.fields_for :magic_fields do |mf|
            = render "magic_field_fields", f: mf
          .links.pl-2
            = link_to_add_association "Add Custom Fields", f, :magic_fields, class: "btn btn-primary"
  %h4.lead-heading
    Custom Labels
  .lead-body
    .row
      .col-md-12
        #custom_labels.row
          = f.fields_for :custom_labels do |cl|
            = render "custom_label_fields", f: cl
          .links.pl-2
            = link_to_add_association "Add Custom Labels", f, :custom_labels, class: "btn btn-primary"
  %h4.lead-heading
    Notification Events
  .lead-body
    .row
      .col-md-6
        = f.select :events, options_for_select((::Company::EVENTS).map { |k| [k.humanize, k] }, f.object.events), { include_blank: false, include_hidden: false }, class: "form-control multiselect", multiple: true
  %h4.lead-heading
    Settings
  .lead-body
    .row
      = render partial: 'setting', locals: { f: f }
  
  %h4.lead-heading
    Restricted lead fields
  .lead-body
    .row 
      .col-md-6
        = f.select :restricted_lead_fields, options_for_select((::Company.lead_freeze_fields).map { |k| [k.humanize, k] }, f.object.restricted_lead_fields), {}, class: "form-control multiselect", multiple: true
  %h4.lead-heading
    Exotel Integration
  .lead-body
    .row 
      .col-md-12
        %label.mb-3.control-label{ for: "exampleInputFile" } Exotel Integration:
        .row
          = f.fields_for :exotel_integration do |ei|
            .col-md-2
              = ei.text_field :title, class: 'form-control'
            .col-md-2
              = ei.text_field :integration_key, class: "form-control"
            .col-md-2
              = ei.text_field :token, class: "form-control"
            .col-md-2
              = ei.text_field :sid, class: "form-control"
            .col-md-2
              = ei.text_field :callback_url, class: "form-control"
            .col-md-2.d-flex.align-items-center.justify-content-center
              = ei.check_box :active
  %h4.lead-heading
    MailChimp Integration
  .lead-body
    .row 
      .col-md-12
        .row
          = f.fields_for :mailchimp_integration do |mc|
            .col-md-2
              = mc.text_field :integration_key, class: "form-control"
            .col-md-2
              = mc.text_field :token, class: "form-control"
            .col-md-2.d-flex.align-items-center.justify-content-center
              = mc.check_box :active
    
  %h4.lead-heading
    Mcube Integration
  .lead-body
    .row 
      .col-md-12
        .row
          = f.fields_for :mcube_integration do |ei|
            .col-md-2
              = ei.text_field :title, class: 'form-control'
            .col-md-2
              = ei.text_field :integration_key, class: "form-control"
            .col-md-6
              = ei.text_field :callback_url, class: "form-control"
            .col-md-2.d-flex.align-items-center.justify-content-center
              = ei.check_box :active
  %h4.lead-heading
    Sms Integration
  .lead-body
    .row 
      .col-md-12
        .row
          = f.fields_for :sms_integration do |si|
            .col-md-2
              = si.text_field :title, class: 'form-control'
            .col-md-2
              = si.text_field :integration_key, class: "form-control"
            .col-md-6
              = si.text_field :url, class: "form-control"
            .col-md-2.d-flex.align-items-center.justify-content-center
              = si.check_box :active
  %h4.lead-heading
    Knowrality Setting
  .lead-body
    .row 
      .col-md-12
        .row
          = f.fields_for :knowrality_integration do |ki|
            .col-md-4
              = ki.text_field :integration_key, label: 'Application Access Key', class: "form-control"
            .col-md-4
              = ki.text_field :token, label: 'Sr Api Key', class: "form-control"
            .col-md-4.d-flex.align-items-center.justify-content-center
              = ki.check_box :active
  %h4.lead-heading
    Tatatele Setting
  .lead-body
    .row 
      .col-md-12
        .row
          = f.fields_for :tatatele_integration do |ki|
            .col-md-4
              = ki.text_field :integration_key, label: 'Api Key', class: "form-control"
            .col-md-4.d-flex.align-items-center.justify-content-center
              = ki.check_box :active
  %h4.lead-heading
    Tele TeemTech Setting
  .lead-body
    .row 
      .col-md-12
        %label.mb-3.control-label{ for: "exampleInputFile" } Tele TeemTech Setting:
        .row
          = f.fields_for :teleteemtech_integration do |tt|
            .col-md-4
              = tt.text_field :integration_key, label: 'Api Key', class: "form-control"
            .col-md-4
              = tt.text_field :token, label: 'IVR ID', class: "form-control"
            .col-md-4.d-flex.align-items-center.justify-content-center
              = tt.check_box :active
  %h4.lead-heading
    SlashRTC Setting
  .lead-body
    .row 
      .col-md-12
        .row
          = f.fields_for :slashrtc_integration do |ki|
            .col-md-4
              = ki.text_field :integration_key, label: 'Token Id', class: "form-control"
            .col-md-4
              = ki.text_field :domain, label: 'Domain', class: "form-control"
            .col-md-4.d-flex.align-items-center.justify-content-center
              = ki.check_box :active
  %h4.lead-heading
    CallerDesk Setting
  .lead-body
    .row
      .col-md-12
        .row
          = f.fields_for :callerdesk_integration do |ci|
            .col-md-4
              = ci.text_field :integration_key, label: 'Api Key', class: "form-control"
            .col-md-4.d-flex.align-items-center.justify-content-center
              = ci.check_box :active
  %h4.lead-heading
    SMTP Setting
  .lead-body
    .row
      .col-md-12
        .row
          = f.fields_for :smtp_integration do |smtp|
            .col-md-2
              = smtp.text_field :user_name, label: 'User Name', class: "form-control"
            .col-md-2
              = smtp.text_field :token, label: 'Password', class: "form-control"
            .col-md-2
              = smtp.text_field :domain, label: 'Domain', class: "form-control"
            .col-md-2
              = smtp.text_field :address, label: 'Address', class: "form-control"
            .col-md-2.d-flex.align-items-center.justify-content-center
              = smtp.check_box :active
  %h4.lead-heading
    Value First Sms Setting
  .lead-body
    .row
      .col-md-12
        .row
          = f.fields_for :value_first_integration do |vfs|
            .col-md-2
              = vfs.text_field :user_name, label: 'User Name', class: "form-control"
            .col-md-2
              = vfs.text_field :token, label: 'Password', class: "form-control"
            .col-md-2
              = vfs.text_field :sender, label: 'Sender ID', class: "form-control"
            .col-md-2.d-flex.align-items-center.justify-content-center
              = vfs.check_box :active
  %h4.lead-heading
    Whatsapp Setting
  .lead-body
    .row
      .col-md-12
        .row
          = f.fields_for :whatsapp_integration do |wp|
            .col-md-2
              = wp.select :user_name, options_for_select([['panom', 'panom'], ["urbanbliss", "urbanbliss"], ["ceratec", "ceratec"], ["vm builder", "vm builder"], ["shreeji sharan", "shreeji sharan"], ['bharat realty', 'bharat realty'], ['mahadev greens', 'mahadev greens'], ['golden abode', 'golden abode'], ['sk fortune', 'sk fortune'], ['vinra group', 'vinra group'], ['ashapura', 'ashapura'], ['GBK Group', 'GBK Group']], wp.object.user_name), { label: 'Client Name', include_blank: "Client Name" }, class: "form-control"
            .col-md-3
              = wp.text_field :integration_key, label: 'Api Key', class: "form-control"
            .col-md-2
              = wp.text_field :token, label: 'Api Secret Key', class: "form-control"
            .col-md-2
              = wp.select :vendor_name, options_for_select([['aisensy', 'aisensy']], wp.object.vendor_name), { label: 'Vendor Name', include_blank: "Vendor Name" }, class: "form-control"
            .col-md-2.d-flex.align-items-center.justify-content-center
              = wp.check_box :active
  %h4.lead-heading
    Push Notification Setting
  .lead-body
    .row
      .col-md-12
        .row
          = f.fields_for :push_notification_setting do |pn|
            .col-md-4
              = pn.text_field :token, class: "form-control"
            .col-md-4
              = pn.text_field :project_key, class: "form-control"
            .col-md-4.d-flex.align-items-center.justify-content-center
              = pn.check_box :is_active
  %h4.lead-heading
    Mcube Settings
  .lead-body
    .row
      .col-md-12
        #mcube_groups.row.m-0
          = f.fields_for :mcube_groups do |mf|
            = render "mcube_group_fields", f: mf
          .links.pl-2
            = link_to_add_association "Add Mcube Group", f, :mcube_groups, class: "btn btn-primary"
  %h4.lead-heading
    Others
  .lead-body
    .row
      .col-md-3
        .form-group
          = f.email_field :default_from_email, class: "form-control", placeholder: "Default From Email", label: "Default From Email", required: true
      .col-md-12
        .form-group
          = f.check_box :remove_closed
      .col-md-12
        .form-group
          = f.text_area :description, class: "form-control", placeholder: "Description"
      

  .my-4
    .row
      .col-md-12
        = button_tag type: "submit", class: "btn btn-new", data: { disable_with: "Please Wait..." } do
        
          Save
        = link_to companies_path, class: "btn btn-delete" do
        
          Cancel
:javascript
  $('.multiselect').multiSelect();
